{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{474:function(s,a,n){\"use strict\";n.r(a);var t=n(3),e=Object(t.a)({},(function(){var s=this,a=s._self._c;return a(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":s.$parent.slotKey}},[a(\"h2\",{attrs:{id:\"_0x00-环境准备-nginx安装了lua模块\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_0x00-环境准备-nginx安装了lua模块\"}},[s._v(\"#\")]),s._v(\" 0x00 环境准备，nginx安装了lua模块\")]),s._v(\" \"),a(\"ul\",[a(\"li\",[s._v(\"可先按照以下方式编译安装lua模块\")]),s._v(\" \"),a(\"li\",[s._v(\"Docker源码编译Nginx[可指定模块]：\"),a(\"a\",{attrs:{href:\"https://conimi.com/archives/109\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"https://conimi.com/archives/109\"),a(\"OutboundLink\")],1)]),s._v(\" \"),a(\"li\",[s._v(\"目录结构遵循上篇博客：Docker源码编译Nginx[可指定模块]\")])]),s._v(\" \"),a(\"h2\",{attrs:{id:\"_0x01-下载ngx-metric\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_0x01-下载ngx-metric\"}},[s._v(\"#\")]),s._v(\" 0x01 下载ngx_metric\")]),s._v(\" \"),a(\"p\",[s._v(\"ngx_metric地址：https://github.com/GuyCheung/falcon-ngx_metric\")]),s._v(\" \"),a(\"p\",[s._v(\"nginx目录下文件结构应为，只增加了\"),a(\"code\",[s._v(\"falcon-ngx_metric\")]),s._v(\"文件夹\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[s._v(\"nginx\\n    - conf.d\\n    - falcon-ngx_metric\\n    -- lua\\n        --- ngx_metric\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),s._v(\"还有其它文件，不列出了\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\"\\n        *** ngx_metric.lua\\n        *** ngx_metric_output.lua\\n    ** ngx_metric.conf\\n    ** nginx_collect.py\\n    - log\\n    * Dockerfile\\n    * nginx.conf\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 约定：\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#    - 表示目录\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#    * 表示文件\")]),s._v(\"\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),a(\"br\")])]),a(\"h2\",{attrs:{id:\"_0x02-修改dockerfile\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_0x02-修改dockerfile\"}},[s._v(\"#\")]),s._v(\" 0x02 修改Dockerfile\")]),s._v(\" \"),a(\"p\",[s._v(\"由于需要python环境，所以安装python\")]),s._v(\" \"),a(\"p\",[s._v(\"Dockerfile内容如下\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-dockerfile line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-dockerfile\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"FROM\")]),s._v(\" debian:10.2-slim\")]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"LABEL\")]),s._v(\" maintainer=\"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"info@fabiocicerchia.it\"')])]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"LABEL\")]),s._v(\" Author=\"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"https://github.com/fabiocicerchia/nginx-lua/blob/master/nginx/1.18.0/debian/10.2-slim\"')])]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ARG\")]),s._v(\" BUILD_DATE\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ARG\")]),s._v(\" BUILD_VERSION\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ARG\")]),s._v(\" VCS_REF\")]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"LABEL\")]),s._v(\" org.label-schema.schema-version=\"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"1.0\"')])]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"LABEL\")]),s._v(\" org.label-schema.build-date=\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$BUILD_DATE\")])]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"LABEL\")]),s._v(\" org.label-schema.name=\"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"fabiocicerchia/nginx-lua\"')])]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"LABEL\")]),s._v(\" org.label-schema.description=\"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"Nginx 1.18.0 with LUA support based on debian 10.2-slim.\"')])]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"LABEL\")]),s._v(\" org.label-schema.url=\"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"https://github.com/fabiocicerchia/nginx-lua\"')])]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"LABEL\")]),s._v(\" org.label-schema.vcs-url=\"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"https://github.com/fabiocicerchia/nginx-lua\"')])]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"LABEL\")]),s._v(\" org.label-schema.vcs-ref=\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$VCS_REF\")])]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"LABEL\")]),s._v(\" org.label-schema.version=\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$BUILD_VERSION\")])]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"LABEL\")]),s._v(\" org.label-schema.docker.cmd=\"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"docker run -p 80:80 -d fabiocicerchia/nginx-lua:1.18.0-debian10.2-slim\"')])]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# https://github.com/openresty/luajit2\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" VER_LUAJIT 2.1-20200102\")]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# https://github.com/openresty/lua-nginx-module\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# Production ready.\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" VER_LUA_NGINX_MODULE 0.10.15\")]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# https://github.com/openresty/lua-resty-core\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# This library is production ready.\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" VER_LUA_RESTY_CORE 0.1.17\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" LUA_LIB_DIR /usr/local/share/lua/5.1\")]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# https://github.com/openresty/lua-resty-lrucache\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# This library is considered production ready.\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" VER_LUA_RESTY_LRUCACHE 0.09\")]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# https://github.com/nginx/nginx\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" VER_NGINX 1.18.0\")]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# https://github.com/vision5/ngx_devel_kit\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# The NDK is now considered to be stable.\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" VER_NGX_DEVEL_KIT 0.3.1\")]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# https://github.com/Yelp/dumb-init\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" VER_DUMBINIT 1.2.2\")]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" LUAJIT_LIB /usr/local/lib\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" LUAJIT_INC /usr/local/include/luajit-2.1\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" LD_LIBRARY_PATH /usr/local/lib/:\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$LD_LIBRARY_PATH\")])]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" DEBIAN_FRONTEND noninteractive\")]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"RUN\")]),s._v(\" set -x \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& apt-get update \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& apt-get install -y --no-install-recommends --no-install-suggests \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    ca-certificates \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    libgeoip-dev \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    libpcre3-dev \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    libssl-dev \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    zlib1g-dev \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& apt-get install -y --no-install-recommends --no-install-suggests \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    curl \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    g++ \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    gzip \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    make \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    tar \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"## 添加的python和pip环境\")]),s._v(\"\\n&& apt-get install -y --no-install-recommends --no-install-suggests \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    python2.7 \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    python-pip \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& pip2 install requests \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& apt-get remove -y python-pip \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& apt-get autoremove -y  \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& apt-get autoclean -y  \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# OpenResty LUAJIT2\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# ##############################################################################\")]),s._v(\"\\n&& curl -Lo /luajit.tar.gz https://github.com/openresty/luajit2/archive/v\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUAJIT}\")]),s._v(\".tar.gz \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && tar xvzf /luajit.tar.gz && rm /luajit.tar.gz \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && cd /luajit2-\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUAJIT}\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && make -j \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"$(nproc)\"')]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && make install \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && cd / \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# LUA Resty Core\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# ##############################################################################\")]),s._v(\"\\n&& curl -Lo /lua-resty-core.tar.gz https://github.com/openresty/lua-resty-core/archive/v\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUA_RESTY_CORE}\")]),s._v(\".tar.gz \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && tar xvzf /lua-resty-core.tar.gz && rm /lua-resty-core.tar.gz \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && cd /lua-resty-core-\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUA_RESTY_CORE}\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && make -j \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"$(nproc)\"')]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && make install \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && cd / \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# LUA Resty LRUCache\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# ##############################################################################\")]),s._v(\"\\n&& curl -Lo /lua-resty-lrucache.tar.gz https://github.com/openresty/lua-resty-lrucache/archive/v\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUA_RESTY_LRUCACHE}\")]),s._v(\".tar.gz \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && tar xvzf /lua-resty-lrucache.tar.gz && rm /lua-resty-lrucache.tar.gz \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && cd /lua-resty-lrucache-\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUA_RESTY_LRUCACHE}\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && make -j \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"$(nproc)\"')]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && make install \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && cd / \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# NGX Devel Kit\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# ##############################################################################\")]),s._v(\"\\n&& curl -Lo /ngx_devel_kit.tar.gz https://github.com/vision5/ngx_devel_kit/archive/v\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_NGX_DEVEL_KIT}\")]),s._v(\".tar.gz \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && tar xvzf /ngx_devel_kit.tar.gz && rm /ngx_devel_kit.tar.gz \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# Lua Nginx Module\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# ##############################################################################\")]),s._v(\"\\n&& curl -Lo /lua-nginx.tar.gz https://github.com/openresty/lua-nginx-module/archive/v\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUA_NGINX_MODULE}\")]),s._v(\".tar.gz \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && tar xvzf /lua-nginx.tar.gz && rm /lua-nginx.tar.gz \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# NGINX\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# ##############################################################################\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# create nginx user/group first, to be consistent throughout docker variants\")]),s._v(\"\\n&& addgroup --system --gid 32548 nginx \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& adduser --system --disabled-login --ingroup nginx --no-create-home --home /nonexistent --gecos \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"nginx user\"')]),s._v(\" --shell /bin/false --uid 32548 nginx \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# we're on an architecture upstream doesn't officially build for\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# let's build binaries from the published packaging sources\")]),s._v(\"\\n    && curl -Lo /nginx.tar.gz https://nginx.org/download/nginx-\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_NGINX}\")]),s._v(\".tar.gz \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && tar xvzf /nginx.tar.gz && rm /nginx.tar.gz \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && cd /nginx-\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_NGINX}\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && mkdir -p /var/cache/nginx/client_temp \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        /var/cache/nginx/proxy_temp \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        /var/cache/nginx/fastcgi_temp \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        /var/cache/nginx/uwsgi_temp \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        /var/cache/nginx/scgi_temp \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && ./configure \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --prefix=/etc/nginx \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --sbin-path=/usr/sbin/nginx \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --modules-path=/usr/lib/nginx/modules \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --conf-path=/etc/nginx/nginx.conf \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --error-log-path=/var/log/nginx/error.log \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --http-log-path=/var/log/nginx/access.log \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --pid-path=/var/run/nginx.pid \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --lock-path=/var/run/nginx.lock \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --http-client-body-temp-path=/var/cache/nginx/client_temp \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --http-proxy-temp-path=/var/cache/nginx/proxy_temp \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --http-scgi-temp-path=/var/cache/nginx/scgi_temp \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --user=nginx \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --group=nginx \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-compat \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-file-aio \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-threads \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_addition_module \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_auth_request_module \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_dav_module \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_flv_module \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_gunzip_module \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_gzip_static_module \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_mp4_module \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_random_index_module \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_realip_module \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_secure_link_module \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_slice_module \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_ssl_module \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_stub_status_module \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_sub_module \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_v2_module \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-mail \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-mail_ssl_module \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-stream \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-stream_realip_module \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-stream_ssl_module \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-stream_ssl_preread_module \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-cc-opt=\"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'-g -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -fPIC'\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-ld-opt=\"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'-Wl,-z,relro -Wl,-z,now -Wl,--as-needed -pie'\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --add-module=/lua-nginx-module-\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUA_NGINX_MODULE}\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --add-module=/ngx_devel_kit-\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_NGX_DEVEL_KIT}\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_dav_module \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_geoip_module \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && make -j \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"$(nproc)\"')]),s._v(\" build \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && make install \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# Bring in tzdata so users could set the timezones through the environment\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# variables\")]),s._v(\"\\n&& apt-get install -y --no-install-recommends --no-install-suggests tzdata \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# Bring in curl and ca-certificates to make registering on DNS SD easier\")]),s._v(\"\\n&& apt-get install -y --no-install-recommends --no-install-suggests curl ca-certificates \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# forward request and error logs to docker log collector\")]),s._v(\"\\n&& ln -sf /dev/stdout /var/log/nginx/access.log \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& ln -sf /dev/stderr /var/log/nginx/error.log \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# dumb-init\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# ##############################################################################\")]),s._v(\"\\n&& curl -Lo /usr/bin/dumb-init https://github.com/Yelp/dumb-init/releases/download/v\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_DUMBINIT}\")]),s._v(\"/dumb-init_\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_DUMBINIT}\")]),s._v(\"_x86_64 \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& chmod +x /usr/bin/dumb-init \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# Cleanup\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# ##############################################################################\")]),s._v(\"\\n&& rm -rf /lua-nginx-module-\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUA_NGINX_MODULE}\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& rm -rf /lua-resty-core-\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUA_RESTY_CORE}\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& rm -rf /lua-resty-lrucache-\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUA_RESTY_LRUCACHE}\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& rm -rf /luajit2-\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUAJIT}\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& rm -rf /nginx-\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_NGINX}\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& rm -rf /ngx_devel_kit-\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_NGX_DEVEL_KIT}\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& apt-get autoremove -y \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& apt-get remove -y \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    curl \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    g++ \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    make \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& rm -rf /var/lib/apt/lists/*\")]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"HEALTHCHECK\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token options\"}},[a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v(\"--interval\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"30s\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v(\"--timeout\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"3s\")])]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"CMD\")]),s._v(\" curl --fail http://localhost/ || exit 1\")]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"EXPOSE\")]),s._v(\" 80\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"EXPOSE\")]),s._v(\" 443\")]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"STOPSIGNAL\")]),s._v(\" SIGTERM\")]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENTRYPOINT\")]),s._v(\" [\"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"dumb-init\"')]),s._v(\"]\")]),s._v(\"\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"CMD\")]),s._v(\" [\"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"nginx\"')]),s._v(\", \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"-g\"')]),s._v(\", \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"daemon off;\"')]),s._v(\"]\")]),s._v(\"\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"27\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"28\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"29\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"30\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"31\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"32\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"33\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"34\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"35\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"36\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"37\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"38\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"39\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"40\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"41\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"42\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"43\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"44\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"45\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"46\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"47\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"48\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"49\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"50\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"51\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"52\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"53\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"54\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"55\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"56\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"57\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"58\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"59\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"60\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"61\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"62\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"63\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"64\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"65\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"66\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"67\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"68\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"69\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"70\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"71\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"72\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"73\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"74\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"75\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"76\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"77\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"78\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"79\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"80\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"81\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"82\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"83\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"84\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"85\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"86\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"87\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"88\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"89\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"90\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"91\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"92\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"93\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"94\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"95\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"96\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"97\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"98\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"99\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"100\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"101\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"102\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"103\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"104\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"105\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"106\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"107\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"108\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"109\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"110\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"111\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"112\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"113\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"114\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"115\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"116\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"117\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"118\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"119\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"120\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"121\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"122\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"123\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"124\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"125\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"126\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"127\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"128\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"129\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"130\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"131\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"132\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"133\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"134\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"135\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"136\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"137\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"138\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"139\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"140\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"141\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"142\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"143\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"144\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"145\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"146\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"147\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"148\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"149\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"150\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"151\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"152\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"153\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"154\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"155\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"156\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"157\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"158\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"159\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"160\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"161\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"162\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"163\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"164\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"165\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"166\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"167\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"168\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"169\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"170\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"171\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"172\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"173\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"174\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"175\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"176\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"177\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"178\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"179\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"180\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"181\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"182\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"183\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"184\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"185\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"186\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"187\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"188\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"189\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"190\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"191\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"192\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"193\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"194\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"195\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"196\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"197\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"198\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"199\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"200\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"201\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"202\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"203\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"204\")]),a(\"br\")])]),a(\"h2\",{attrs:{id:\"_0x03-编写docker-comopose文件\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_0x03-编写docker-comopose文件\"}},[s._v(\"#\")]),s._v(\" 0x03 编写docker-comopose文件\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-docker line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-docker\"}},[a(\"code\",[s._v('version: \"3.7\"\\n\\nservices:\\n    nginx:\\n        build:\\n            context: .\\n            dockerfile: compose/nginx/Dockerfile\\n        restart: always\\n        container_name: nginx\\n        volumes:\\n            - ./wwwroot/demo:/home/wwwroot\\n            - ./compose/nginx/conf.d:/etc/nginx/conf.d\\n            - ./compose/nginx/nginx.conf:/etc/nginx/nginx.conf\\n            - ./compose/nginx/log:/var/log/nginx\\n            '),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 安装ngx_metric\")]),s._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 这里由于容器内不存在modules文件夹，所以可以直接映射，\")]),s._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 如果容器内存在moduls文件夹且还要其它文件，那么这里就需要将lua文件夹下的内容一个一个文件映射\")]),s._v(\"\\n            - ./compose/nginx/falcon-ngx_metric/lua:/etc/nginx/modules\\n            - ./compose/nginx/falcon-ngx_metric/ngx_metric.conf:/etc/nginx/conf.d/ngx_metric.conf\\n            - ./compose/nginx/falcon-ngx_metric/nginx_collect.py:/opt/nginx_collect.py\\n\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 需要注意：主机文件挂载到容器内存在几种形式\")]),s._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 1. 用主机内的文件替换容器内的文件，比如容器内存在nginx.conf，主机内也存在nginx.conf，\")]),s._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 这时需要用容器的文件代替主机文件，./compose/nginx/nginx.conf:/etc/nginx/nginx.conf就会覆盖容器内的原有文件\")]),s._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 2. 将主机文件夹下的文件全部挂载到容器内，比如将主机内的/home/wwwroot/demo下的所有文件映射到容器，\")]),s._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 这时./wwwroot/demo:/home/wwwroot就会在容器内创建一个/home/wwwroot文件夹，主机demo文件夹内的所有文件都会映射到容器/home/wwwroot文件夹下\")]),s._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 3. 将容器内的文件夹挂载到主机，比如容器内/var/log/nginx文件下的日志文件会全部映射到主机./compose/nginx/log文件夹下\")]),s._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 4. 将主机内的文件挂载到容器内，即使容器内不存在需要挂载的文件，比如：容器内/etc/nginx/conf.d/文件夹下不存在ngx_metric.conf,\")]),s._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 但也要注意要写出容器内的文件名，./compose/nginx/falcon-ngx_metric/ngx_metric.conf:/etc/nginx/conf.d/ngx_metric.conf，\")]),s._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 两边都有ngx_metric.conf文件名\")]),s._v('\\n\\n        ports:\\n            - \"80:80\"\\n\\n        '),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# command: \")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#     - bash\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#     - -c\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#     - |\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#         sleep 20s\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#         python2.7 /opt/nginx_collect.py --format=falcon --falcon-addr=http://116.62.39.165:1988/v1/push --service=ok_nginx\")]),s._v(\"\\n\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# --falcon-addr 为agent地址\")]),s._v(\"\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"27\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"28\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"29\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"30\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"31\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"32\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"33\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"34\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"35\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"36\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"37\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"38\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"39\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"40\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"41\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"42\")]),a(\"br\")])]),a(\"h2\",{attrs:{id:\"_0x04-添加定时命令-自动推送\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_0x04-添加定时命令-自动推送\"}},[s._v(\"#\")]),s._v(\" 0x04 添加定时命令，自动推送\")]),s._v(\" \"),a(\"p\",[s._v(\"运行命令\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[s._v(\"    python2.7 /opt/nginx_collect.py \"),a(\"span\",{pre:!0,attrs:{class:\"token parameter variable\"}},[s._v(\"--format\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"falcon --use-ngx-host --falcon-addr\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"http://116.62.39.165:1988/v1/push\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"p\",[s._v(\"参数说明\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# Github地址：https://github.com/GuyCheung/falcon-ngx_metric\")]),s._v(\"\\n\\n--use-ngx-host: 使用nginx配置里的service_name作为采集项的endpoint\\n\\n--service: 手动设置endpoint值，当指定--use-ngx-host时，该参数无效\\n\\n--format: 采集数据输出格式，对接falcon请使用--format\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"falcon\\n\\n--falcon-step: falcon step设置，请设置为python脚本调用频率，默认是60\\n\\n--falcon-addr: falcon push接口设置，设置该参数数据直接推送，不再输出到终端。需要安装requests模块\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\")])])])}),[],!1,null,null,null);a.default=e.exports}}]);","extractedComments":[]}